<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Feature Flow Diagram • ShinyImgVoteR</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Feature Flow Diagram"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ShinyImgVoteR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Feature Flow Diagram</h1>

    </div>

<div id="feature-flow-diagram" class="section level1">

<div class="section level2">
<h2 id="database-update-flow">Database Update Flow<a class="anchor" aria-label="anchor" href="#database-update-flow"></a></h2>
<pre><code>┌─────────────────────────────────────────────────────────────────┐
│                         Shiny App Starts                        │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│             Admin Panel Loaded (mod_admin.R)                    │
│  • "Update Database" button available to admin users            │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Admin clicks   │
                    │ "Update Database"│
                    └────────┬────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│          Call update_annotations_table() (db_utils.R)           │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
                   ┌─────────────────────────────────────┐
                   │   Read to_be_voted_images_file      │
                   │   Get existing DB entries           │
                   │   Create unique keys:               │
                   │   key = coordinates|REF|ALT         │
                   └──────────┬──────────────────────────┘
                              │
                              ▼
                   ┌─────────────────────────────────────┐
                   │   Find New Entries                  │
                   │   new = file_keys - db_keys         │
                   └──────────┬──────────────────────────┘
                              │
                    ┌─────────┴─────────┐
                    │                   │
               No New Entries      New Entries Found
                    │                   │
                    ▼                   ▼
          ┌──────────────────┐  ┌─────────────────────────┐
          │ Log: No new      │  │ Process paths           │
          │ entries found    │  │ Insert into DB          │
          │ Return 0         │  │ Return count            │
          └──────────────────┘  └──────┬──────────────────┘
                    │                   │
                    │                   ▼
                    │         ┌──────────────────────────┐
                    │         │ Show Modal Dialog        │
                    │         │ "Successfully added      │
                    │         │  X new entries"          │
                    │         └──────────────────────────┘
                    │
                    └────────────────────────────┐
                                                 │
                                                 ▼
                                   ┌──────────────────────┐
                                   │ Close modal          │
                                   │ Continue operation   │
                                   └──────────────────────┘</code></pre>
</div>
<div class="section level2">
<h2 id="key-components">Key Components<a class="anchor" aria-label="anchor" href="#key-components"></a></h2>
<div class="section level3">
<h3 id="id_1-admin-panel-button-mod_adminr">1. Admin Panel Button (mod_admin.R)<a class="anchor" aria-label="anchor" href="#id_1-admin-panel-button-mod_adminr"></a></h3>
<ul><li>
<strong>Trigger</strong>: Admin user clicks “Update Database” button</li>
<li>
<strong>Function</strong>: Triggers on-demand database update</li>
<li>
<strong>Action</strong>: Calls <code><a href="reference/update_annotations_table.html">update_annotations_table()</a></code> and shows result in modal</li>
</ul></div>
<div class="section level3">
<h3 id="id_2-database-update-db_utilsr">2. Database Update (db_utils.R)<a class="anchor" aria-label="anchor" href="#id_2-database-update-db_utilsr"></a></h3>
<ul><li>
<strong>Function</strong>: <code>update_annotations_table(conn, to_be_voted_images_file)</code>
</li>
<li>
<strong>Logic</strong>:
<ol style="list-style-type: decimal"><li>Read file into data frame</li>
<li>Query existing DB entries</li>
<li>Compare using composite key (coordinates|REF|ALT)</li>
<li>Insert only new entries</li>
</ol></li>
<li>
<strong>Return</strong>: Integer count of new entries added</li>
</ul></div>
<div class="section level3">
<h3 id="id_3-user-feedback-mod_adminr">3. User Feedback (mod_admin.R)<a class="anchor" aria-label="anchor" href="#id_3-user-feedback-mod_adminr"></a></h3>
<ul><li>
<strong>Success</strong>: Shows modal dialog with count of entries added</li>
<li>
<strong>No Updates</strong>: Shows modal dialog “No new entries found”</li>
<li>
<strong>Error</strong>: Shows modal dialog with error message</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="duplicate-prevention-strategy">Duplicate Prevention Strategy<a class="anchor" aria-label="anchor" href="#duplicate-prevention-strategy"></a></h2>
<pre><code>File Entry: chr1:1000|A|T
DB Entry:   chr1:1000|A|T
Comparison: MATCH → Skip (already exists)

File Entry: chr1:1000|G|C
DB Entry:   chr1:1000|A|T
Comparison: NO MATCH → Add (different mutation at same position)</code></pre>
</div>
<div class="section level2">
<h2 id="error-handling">Error Handling<a class="anchor" aria-label="anchor" href="#error-handling"></a></h2>
<pre><code>Try:
  ├─ Checkout DB connection from pool
  ├─ Call update_annotations_table()
  ├─ Show success modal to admin user (if new entries)
  └─ Return connection to pool

Catch:
  ├─ Log error to console
  ├─ Show error modal to admin user
  └─ Return connection to pool

Finally:
  └─ Connection properly returned via on.exit()</code></pre>
</div>
<div class="section level2">
<h2 id="timeline-example">Timeline Example<a class="anchor" aria-label="anchor" href="#timeline-example"></a></h2>
<pre><code>Time    Action
------- ----------------------------------------------------------
00:00   App starts, admin panel loaded with "Update Database" button
00:15   Admin adds new entries to to_be_voted_images.tsv
00:20   Admin clicks "Update Database" button
00:20   Read file, compare with DB, find 3 new entries
00:20   Insert 3 entries into DB
00:20   Show modal to admin: "Successfully added 3 new entries to the database"
00:20   Admin closes modal
00:21   New images available for voting to all users</code></pre>
</div>
<div class="section level2">
<h2 id="performance-characteristics">Performance Characteristics<a class="anchor" aria-label="anchor" href="#performance-characteristics"></a></h2>
<ul><li>
<strong>Update Trigger</strong>: On-demand (admin button click)</li>
<li>
<strong>Detection Latency</strong>: Immediate (no waiting for polling)</li>
<li>
<strong>Update Time</strong>:
<ul><li>1 entry: &lt;1 second</li>
<li>10 entries: &lt;2 seconds</li>
<li>100 entries: &lt;5 seconds</li>
</ul></li>
<li>
<strong>Resource Usage</strong>:
<ul><li>Idle: Zero (no polling overhead)</li>
<li>Update: Moderate (DB query + insert operations)</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="integration-points">Integration Points<a class="anchor" aria-label="anchor" href="#integration-points"></a></h2>
<ol style="list-style-type: decimal"><li>
<strong>Config System</strong>: Uses <code>cfg$to_be_voted_images_file</code> from config.yaml</li>
<li>
<strong>Database Pool</strong>: Uses existing <code>db_pool</code> for connections</li>
<li>
<strong>Admin Panel</strong>: Button integrated into existing admin UI</li>
<li>
<strong>Modal Dialogs</strong>: Consistent UI feedback mechanism</li>
<li>
<strong>Voting Module</strong>: New entries automatically available for voting</li>
</ol></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ivo Christopher Leist.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

